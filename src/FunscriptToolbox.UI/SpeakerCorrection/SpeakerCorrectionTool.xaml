<Window x:Class="FunscriptToolbox.UI.SpeakerCorrection.SpeakerCorrectionTool"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Speaker Diarization Correction Tool" Height="800" Width="1400">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel -->
            <Border Grid.Column="0" BorderBrush="#BDC3C7" BorderThickness="0,0,1,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Background="#34495E" Padding="10">
                        <TextBlock Text="Speaker Management" Foreground="White" FontSize="16" FontWeight="SemiBold"/>
                    </Border>
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="10">
                            <TextBlock Text="All Speakers" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ListBox Name="SpeakersAndGroupsList" Height="Auto" MinHeight="350" SelectionMode="Extended" SelectionChanged="SpeakersAndGroupsList_SelectionChanged">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Padding" Value="5"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <!-- Use a Grid to align elements horizontally -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Speaker Name and Counts -->
                                            <TextBlock Grid.Column="0" VerticalAlignment="Center">
                                                <Run Text="{Binding DisplayName}" FontWeight="Bold"/>
                                                <TextBlock Foreground="Gray" Margin="5,0,0,0">
                                                    <TextBlock.Text>
                                                        <MultiBinding StringFormat="({0}/{1})">
                                                            <Binding Path="FinalizedCount"/>
                                                            <Binding Path="TotalCount"/>
                                                        </MultiBinding>
                                                    </TextBlock.Text>
                                                </TextBlock>
                                            </TextBlock>

                                            <!-- Key Display -->
                                            <Border Grid.Column="1" Background="#ECF0F1" BorderBrush="#BDC3C7" BorderThickness="1" CornerRadius="3" Padding="6,3" Margin="0,0,8,0" MinWidth="25" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding AssignedKeyDisplay}" HorizontalAlignment="Center" FontWeight="Bold" Foreground="#34495E"/>
                                            </Border>

                                            <!-- Assign Key Button -->
                                            <Button Grid.Column="2" Name="AssignKeyButton" Content="Assign Key" FontSize="10" Padding="5,2" Margin="0,0,5,0"
                                                    Click="AssignKeyButton_Click"
                                                    Tag="{Binding}"/>
                                            
                                            <Button Grid.Column="3" Name="ValidateSpeakerButton" Content="Validate" FontSize="10" Padding="5,2"
                                                    Click="ValidateSpeakerButton_Click"
                                                    Tag="{Binding}"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <Grid Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Button Name="MergeButton" Grid.Column="1" Content="Merge Selected" Click="MergeButton_Click" Padding="10,5" Background="#3498DB" Foreground="White" />
                            </Grid>

                            <Grid Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Name="RenameTextBox" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <Button Name="RenameButton" Grid.Column="1" Content="Rename" Click="RenameButton_Click" Padding="10,5" Background="#3498DB" Foreground="White"/>
                            </Grid>
                            <Grid Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Name="AddSpeakerTextBox" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <Button Name="AddButton" Grid.Column="1" Content="Add New" Click="AddButton_Click" Padding="10,5" Background="#16A085" Foreground="White"/>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                    <StackPanel Grid.Row="2" Margin="10" Orientation="Vertical">
                        <Button Name="StartAllValidationButton" Content="Start Validation (All)" Click="StartAllValidationButton_Click" Padding="10" Background="#E74C3C" Foreground="White" FontWeight="Bold" Margin="0,5"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Right Panel (No changes here) -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Border Grid.Row="0" Background="#ECF0F1" Margin="10">
                    <Grid>
                        <MediaElement Name="VideoPlayer" LoadedBehavior="Manual" UnloadedBehavior="Manual" Stretch="Uniform"/>
                        <TextBlock Name="VideoPlaceholder" Text="Video will appear here" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" Foreground="#7F8C8D"/>
                    </Grid>
                </Border>
                <Border Grid.Row="1" Margin="10" Padding="15" Background="#FFFFFF" BorderBrush="#BDC3C7" BorderThickness="1">
                    <StackPanel>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Time:" FontWeight="Bold" Margin="0,2,10,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Name="TimeRangeText" Margin="0,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Potential Speakers:" FontWeight="Bold" Margin="0,2,10,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Name="PotentialSpeakersText" TextWrapping="Wrap" Margin="0,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="AI Detected:" FontWeight="Bold" Margin="0,2,10,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Name="AIDetectedText" Margin="0,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Segment Index:" FontWeight="Bold" Margin="0,2,10,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Name="SegmentIndexText" Margin="0,2" VerticalAlignment="Center"/>
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Manual Override:" FontWeight="Bold" Margin="0,2,10,2" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="4" Grid.Column="1" Name="ManualSpeakerTextBox" Margin="0,2" VerticalAlignment="Center"/>
                        </Grid>
                        <Separator Margin="0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Name="SkipButton" Content="→ Skip (S)" Click="SkipButton_Click" Height="50" Margin="2" Background="#F39C12" Foreground="White" FontSize="14" FontWeight="Bold"/>
                            <Button Grid.Column="1" Name="ApplyManualButton" Content="Apply Manual (M)" Click="ApplyManualButton_Click" Height="50" Margin="2" Background="#3498DB" Foreground="White" FontSize="14" FontWeight="Bold"/>
                            <Button Grid.Column="2" Name="UndoButton" Content="Undo (Ctrl+Z)" Click="UndoButton_Click" Height="50" Margin="2" Background="#7F8C8D" Foreground="White" FontSize="14" FontWeight="Bold"/>
                            <Button Grid.Column="3" Name="PauseButton" Content="❚❚ Pause (Space)" Click="PauseButton_Click" Height="50" Margin="2" Background="#8E44AD" Foreground="White" FontSize="14" FontWeight="Bold"/>
                            <Button Grid.Column="4" Name="ExtendButton" Content="← Extend Duration →" Click="ExtendButton_Click" Height="50" Margin="2" Background="#7F8C8D" Foreground="White" FontSize="14" FontWeight="Bold"/>
                        </Grid>
                    </StackPanel>
                </Border>
                <Border Grid.Row="2" Background="#34495E" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Progress:" Foreground="White" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <ProgressBar Grid.Column="1" Name="ValidationProgress" Height="20" Minimum="0" Maximum="100"/>
                        <TextBlock Grid.Column="2" Name="ProgressText" Text="0 / 0" Foreground="White" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    </Grid>
                </Border>
            </Grid>
        </Grid>

        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Name="StatusText" Text="Ready"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Name="FilePathText" Text="No file loaded"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>